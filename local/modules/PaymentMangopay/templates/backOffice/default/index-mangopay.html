{extends file="mangopay.tpl"}
{default_translation_domain domain='mangopay'}

{block name="no-return-functions"}
{$admin_current_location = 'modules'}
{/block}

{block name="page-title"}Mangopay{/block}

{block name="check-resource"}admin.module{/block}
{block name="check-access"}view{/block}
{block name="check-module"}Mangopay{/block}

{block name="main-content"}
<div id="wrapper" class="container">

    {if $general_error}
    <div class="alert alert-danger">
        {$general_error}
    </div>
    {/if}

    <div class="general-block-decorator">

        {include file="includes/mangopay_menu.html" selected_menu="configuration"}
        <div class="row">
            <div class="col-md-6">
                <h1>Configuration</h1>
                {form name="mangopay.configurationform"}
                <form method="POST" action="{url path='admin/module/PaymentMangopay/configuration/update'}" class="form-horizontal">
                    {form_hidden_fields form=$form}

                    {form_field form=$form field="fees"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="{$name}" id="{$label_attr.for}" value="{$value}" />
                            {form_error form=$form field="fees"}
                                <br />
                                <span class="error">{$message}</span>
                            {/form_error}
                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}
                    {form_field form=$form field="clientid"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="{$name}" id="{$label_attr.for}" value="{$value}" />
                            {form_error form=$form field="clientid"}
                                <br />
                                <span class="error">{$message}</span>
                            {/form_error}
                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}
                    {form_field form=$form field="clientpassword"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="{$name}" id="{$label_attr.for}" value="{$value}" />
                            {form_error form=$form field="clientpassword"}
                                <br />
                                <span class="error">{$message}</span>
                            {/form_error}
                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}
                    {form_field form=$form field="temporaryfolder"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="{$name}" id="{$label_attr.for}" value="{$value}" />
                            {form_error form=$form field="temporaryfolder"}
                                <br />
                                <span class="error">{$message}</span>
                            {/form_error}
                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}
                    {form_field form=$form field="deferred_payment"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <div class="radio">
                                <label>
                                <input type="radio" name="{$name}" value="0" {if $value eq 0} checked {/if}>
                                Non
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                <input type="radio" name="{$name}" value="1" {if $value eq 1} checked {/if}>
                                Oui
                                </label>
                            </div>

                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}
                    {form_field form=$form field="days"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="{$name}" id="{$label_attr.for}" value="{$value}" />
                            {form_error form=$form field="days"}
                                <br />
                                <span class="error">{$message}</span>
                            {/form_error}
                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}

                    <div class="form-group">

                        <div class="col-sm-8 col-sm-offset-3">
                            <button type="submit"  class="form-submit-button btn btn-sm btn-primary" title="{intl d='mangopay.bo.default' l='Save'}">
                                {intl d='mangopay.bo.default' l='Save'}
                            </button>
                        </div>
                    </div>
                </form>
                {/form}
            </div>
            <div class="col-md-6">
                <h1>Escrow wallet</h1>

                {ifloop rel="formmangopayusersloop"}
                    {loop type="mangopayusersloop" name="formmangopayusersloop" isdefault=1}
                    <a class="btn btn-primary action-btn mangopay-ajax-action" title="{intl l='Edit this user' d='paymentmangopay.bo.default'}"  href="{url path="/admin/module/PaymentMangopay/user/$USER/legaluser-edit-modal"}">
                        <i class="glyphicon glyphicon-edit"></i> {intl d='mangopay.bo.default' l='Edit escrow'}
                    </a>
                    {/loop}
                {/ifloop}
                {elseloop rel="formmangopayusersloop"}
                    <a class="btn btn-primary action-btn" title="Ajouter une personne morale" href="#legaluser_creation_dialog" data-toggle="modal">
                    <span class="glyphicon glyphicon-home"></span> {intl d='mangopay.bo.default' l='Generate escrow'}
                    </a>
                {/elseloop}


                {*
                {form name="mangopay.escrowwallet"}
                <form method="POST" action="{url path='admin/module/PaymentMangopay/escrowwallet/update'}" class="form-horizontal">
                    {form_hidden_fields form=$form}

                    {form_field form=$form field="user"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="{$name}" id="{$label_attr.for}" value="{$value}" />
                            {form_error form=$form field="fees"}
                                <br />
                                <span class="error">{$message}</span>
                            {/form_error}
                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}

                    {form_field form=$form field="wallet"}
                    <div class="form-group">
                        <label for="{$label_attr.for}" class="col-sm-3 control-label">{$label}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="{$name}" id="{$label_attr.for}" value="{$value}" />
                            {form_error form=$form field="fees"}
                                <br />
                                <span class="error">{$message}</span>
                            {/form_error}
                            {if ! empty($label_attr.help)}
                                <span class="help-block">{$label_attr.help}</span>
                            {/if}
                        </div>
                    </div>
                    {/form_field}

                </form>
                {/form}
                *}
            </div>
        </div>


    </div>
</div>


{/block}